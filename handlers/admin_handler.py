# -*- coding: utf-8 -*-
from telegram import Update
from telegram.ext import ContextTypes
from config import Config
import logging

logger = logging.getLogger(__name__)

async def admin_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å"""
    if not Config.is_admin(update.effective_user.id):
        await update.message.reply_text("‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã")
        return
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ª–∏—á–∫–µ
    if update.effective_chat.type != 'private':
        await update.message.reply_text(
            "üì± –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —Å –±–æ—Ç–æ–º.\n\n"
            "üëâ –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –≤ –ª–∏—á–∫—É: @TrixLiveBot",
            parse_mode='Markdown'
        )
        return
    
    admin_text = f"""üîß **–ê–î–ú–ò–ù–°–ö–ê–Ø –ü–ê–ù–ï–õ–¨**

üë§ **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:** @{update.effective_user.username or 'unknown'}
üÜî **ID:** {update.effective_user.id}

**üõ°Ô∏è –ú–û–î–ï–†–ê–¶–ò–Ø:**
‚Ä¢ `/ban @user –ø—Ä–∏—á–∏–Ω–∞` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚Ä¢ `/unban @user` - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
‚Ä¢ `/mute @user 10m` - –∑–∞–º—É—Ç–∏—Ç—å –Ω–∞ –≤—Ä–µ–º—è
‚Ä¢ `/unmute @user` - —Å–Ω—è—Ç—å –º—É—Ç
‚Ä¢ `/banlist` - —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö

**üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:**
‚Ä¢ `/stats` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚Ä¢ `/top` - —Ç–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚Ä¢ `/lastseen @user` - –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

**üîó –°–°–´–õ–ö–ò:**
‚Ä¢ `/trixlinks` - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏
‚Ä¢ `/trixlinksadd` - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É
‚Ä¢ `/trixlinksedit ID` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
‚Ä¢ `/trixlinksdelete ID` - —É–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É

**üéÆ –ò–ì–†–´ (try/need/more):**
‚Ä¢ `/{version}add —Å–ª–æ–≤–æ` - –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ –≤ –∏–≥—Ä—É
‚Ä¢ `/{version}start` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—É—Ä—Å
‚Ä¢ `/{version}guide` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–≥—Ä–∞–º

**‚öôÔ∏è –ê–í–¢–û–ü–û–°–¢–ò–ù–ì:**
‚Ä¢ `/autopost` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞

**üí¨ –°–û–û–ë–©–ï–ù–ò–Ø:**
‚Ä¢ `/say —Ç–µ–∫—Å—Ç` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞

üì± **–í—Å–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –ª–∏—á–∫–µ —Å –±–æ—Ç–æ–º!**"""
    
    await update.message.reply_text(admin_text, parse_mode='Markdown')

async def say_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞"""
    if not Config.is_admin(update.effective_user.id):
        await update.message.reply_text("‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã")
        return
    
    if not context.args:
        await update.message.reply_text(
            "üìù **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞**\n\n"
            "**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `/say —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è`\n"
            "**–ü—Ä–∏–º–µ—Ä:** `/say –ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º! –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞`\n\n"
            "üí° –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ–∫—É—â–∏–π —á–∞—Ç",
            parse_mode='Markdown'
        )
        return
    
    message_text = ' '.join(context.args)
    
    try:
        await context.bot.send_message(
            chat_id=update.effective_chat.id,
            text=message_text,
            parse_mode='Markdown'
        )
        
        # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É
        if update.effective_chat.type != 'private':
            await update.message.reply_text("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
            
    except Exception as e:
        logger.error(f"Error sending say message: {e}")
        await update.message.reply_text("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è")

async def admcom_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥"""
    if not Config.is_moderator(update.effective_user.id):
        await update.message.reply_text("‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã")
        return
    
    admcom_text = """üîß **–°–ü–ò–°–û–ö –ê–î–ú–ò–ù–°–ö–ò–• –ö–û–ú–ê–ù–î**

**üëë –¢–û–õ–¨–ö–û –î–õ–Ø –ê–î–ú–ò–ù–û–í:**
‚Ä¢ `/admin` - –∞–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å
‚Ä¢ `/ban @user –ø—Ä–∏—á–∏–Ω–∞` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
‚Ä¢ `/unban @user` - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
‚Ä¢ `/mute @user –≤—Ä–µ–º—è` - –∑–∞–º—É—Ç–∏—Ç—å (10m, 1h, 1d)
‚Ä¢ `/unmute @user` - —Å–Ω—è—Ç—å –º—É—Ç
‚Ä¢ `/say —Ç–µ–∫—Å—Ç` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞

**üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò –ò–ù–§–û–†–ú–ê–¶–ò–Ø:**
‚Ä¢ `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ –∏ —á–∞—Ç–∞
‚Ä¢ `/top` - —Ç–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
‚Ä¢ `/banlist` - —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
‚Ä¢ `/lastseen @user` - –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
‚Ä¢ `/whois @user` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
‚Ä¢ `/admins` - —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏

**üîó –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–°–´–õ–ö–ê–ú–ò:**
‚Ä¢ `/trixlinks` - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏
‚Ä¢ `/trixlinksadd "–Ω–∞–∑–≤–∞–Ω–∏–µ" "–æ–ø–∏—Å–∞–Ω–∏–µ"` - –¥–æ–±–∞–≤–∏—Ç—å
‚Ä¢ `/trixlinksedit ID` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
‚Ä¢ `/trixlinksdelete ID` - —É–¥–∞–ª–∏—Ç—å

**üéÆ –ò–ì–†–û–í–´–ï –ö–û–ú–ê–ù–î–´ (try/need/more):**
‚Ä¢ `/{version}add —Å–ª–æ–≤–æ` - –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ
‚Ä¢ `/{version}edit —Å–ª–æ–≤–æ –æ–ø–∏—Å–∞–Ω–∏–µ` - –∏–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ
‚Ä¢ `/{version}start` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—É—Ä—Å
‚Ä¢ `/{version}stop` - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—É—Ä—Å
‚Ä¢ `/{version}guide` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚Ä¢ `/{version}rollstart 3` - –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—ã–≥—Ä—ã—à
‚Ä¢ `/{version}reroll` - —Å–±—Ä–æ—Å–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

**‚öôÔ∏è –ê–í–¢–û–ü–û–°–¢–ò–ù–ì:**
‚Ä¢ `/autopost` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚Ä¢ `/autopost "—Ç–µ–∫—Å—Ç" 3600` - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–ø–æ—Å—Ç

**üõ°Ô∏è –ü–†–û–î–í–ò–ù–£–¢–ê–Ø –ú–û–î–ï–†–ê–¶–ò–Ø:**
‚Ä¢ `/del` - —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (—Ä–µ–ø–ª–∞–π)
‚Ä¢ `/purge` - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Ä–µ–ø–ª–∞–π)
‚Ä¢ `/slowmode —Å–µ–∫—É–Ω–¥—ã` - –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º
‚Ä¢ `/lockdown –≤—Ä–µ–º—è` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–∞—Ç–∞
‚Ä¢ `/antiinvite on/off` - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å—Å—ã–ª–æ–∫
‚Ä¢ `/tagall —Å–æ–æ–±—â–µ–Ω–∏–µ` - —É–ø–æ–º—è–Ω—É—Ç—å –≤—Å–µ—Ö

üì± **–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–æ–º–∞–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–∫–µ!**"""
    
    await update.message.reply_text(admcom_text, parse_mode='Markdown')
